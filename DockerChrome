# Use an ARM64 base image with OpenJDK
#FROM arm64v8/openjdk:11-jdk-slim
FROM arm64v8/openjdk:17-jdk-slim

# Set environment variables
ENV MAVEN_VERSION=3.9.5
ENV MAVEN_HOME=/opt/maven
ENV PATH=$MAVEN_HOME/bin:$PATH

# Install Maven
RUN apt-get update && apt-get install -y \
    wget \
    unzip \
    && wget https://downloads.apache.org/maven/maven-3/$MAVEN_VERSION/binaries/apache-maven-$MAVEN_VERSION-bin.zip \
    && unzip apache-maven-$MAVEN_VERSION-bin.zip -d /opt/ \
    && mv /opt/apache-maven-$MAVEN_VERSION $MAVEN_HOME \
    && rm apache-maven-$MAVEN_VERSION-bin.zip \
    && apt-get clean \
    && rm -rf /var/lib/apt/lists/*

# Install necessary packages for Selenium
RUN apt-get update && apt-get install -y \
    curl \
    chromium-driver \
    && apt-get clean \
    && rm -rf /var/lib/apt/lists/*

# Set up working directory
WORKDIR /app

# Copy your Maven project files
COPY pom.xml ./
COPY src ./src

# Build the project
RUN mvn clean package

# Command to run your tests (update as needed)
CMD ["mvn", "test"]